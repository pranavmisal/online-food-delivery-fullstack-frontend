{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../auth/auth.service\";\nexport class CartService {\n  constructor(http, authService) {\n    this.http = http;\n    this.authService = authService;\n    this.cart = [];\n    this.itemAdded = new EventEmitter();\n    // public cartCleared = new Subject<void>();\n    this.cartCleared = new EventEmitter();\n  }\n  addToCart(menuItem, quantity = 1) {\n    const existingItem = this.cart.find(item => item.menuItem.id === menuItem.id);\n    if (existingItem) {\n      existingItem.quantity += quantity;\n      if (existingItem.quantity <= 0) {\n        this.removeFromCart(existingItem.menuItem);\n      }\n    } else {\n      this.cart.push({\n        menuItem,\n        quantity\n      });\n    }\n    this.itemAdded.emit(menuItem);\n  }\n  removeFromCart(menuItem) {\n    this.cart = this.cart.filter(item => item.menuItem.id !== menuItem.id);\n  }\n  getCartItems() {\n    return this.cart;\n  }\n  clearCart() {\n    this.cart = [];\n    this.cartCleared.emit();\n  }\n  getTotalItemCount() {\n    return this.cart.reduce((total, item) => total + item.quantity, 0);\n  }\n  getTotalPrice() {\n    return this.cart.reduce((total, item) => total + item.menuItem.price * item.quantity, 0);\n  }\n  placeOrder() {\n    const user = this.authService.getCurrentUser();\n    const orderDetails = this.cart.map(item => ({\n      menu_item_id: item.menuItem.id,\n      quantity: item.quantity,\n      total_price: item.menuItem.price * item.quantity\n    }));\n    const orderData = {\n      user_id: user.id,\n      orderItems: orderDetails,\n      total_price: this.getTotalPrice()\n    };\n    return this.http.post('/api/orders', orderData);\n  }\n  static #_ = this.ɵfac = function CartService_Factory(t) {\n    return new (t || CartService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.AuthService));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CartService,\n    factory: CartService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["EventEmitter","CartService","constructor","http","authService","cart","itemAdded","cartCleared","addToCart","menuItem","quantity","existingItem","find","item","id","removeFromCart","push","emit","filter","getCartItems","clearCart","getTotalItemCount","reduce","total","getTotalPrice","price","placeOrder","user","getCurrentUser","orderDetails","map","menu_item_id","total_price","orderData","user_id","orderItems","post","_","i0","ɵɵinject","i1","HttpClient","i2","AuthService","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\VI_Pranav\\Desktop\\food-delivery-app\\src\\app\\services\\cart.service.ts"],"sourcesContent":["import { EventEmitter, Injectable } from '@angular/core';\nimport { Menu } from '../models/menu.model';\nimport { Subject } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { AuthService } from '../auth/auth.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CartService {\n  public cart: {menuItem: Menu, quantity: number}[] = [];\n  public itemAdded: EventEmitter<Menu> = new EventEmitter<Menu>();\n  // public cartCleared = new Subject<void>();\n  public cartCleared: EventEmitter<void> = new EventEmitter<void>();\n\n  constructor(public http: HttpClient, public authService: AuthService) { }\n\n  public addToCart(menuItem: Menu, quantity: number = 1){\n    const existingItem = this.cart.find(item => item.menuItem.id === menuItem.id);\n    if (existingItem){\n      existingItem.quantity += quantity;\n      if (existingItem.quantity <= 0){\n        this.removeFromCart(existingItem.menuItem);\n      }\n    } else {\n      this.cart.push({menuItem, quantity});\n    }\n    this.itemAdded.emit(menuItem);\n  }\n\n  public removeFromCart(menuItem: Menu){\n    this.cart = this.cart.filter(item => item.menuItem.id !== menuItem.id);\n  }\n\n  public getCartItems(){\n    return this.cart;\n  }\n\n  public clearCart(){\n    this.cart = [];\n    this.cartCleared.emit();\n  }\n\n  public getTotalItemCount(): number {\n    return this.cart.reduce((total, item) => total + item.quantity, 0);\n  }\n\n  public getTotalPrice(): number{\n    return this.cart.reduce((total, item) => total + (item.menuItem.price * item.quantity), 0);\n  }\n\n  public placeOrder(){\n    const user = this.authService.getCurrentUser();\n    const orderDetails = this.cart.map(item => ({\n      menu_item_id: item.menuItem.id,\n      quantity: item.quantity,\n      total_price: item.menuItem.price * item.quantity\n    }));\n\n    const orderData = {\n      user_id: user.id,\n      orderItems: orderDetails,\n      total_price: this.getTotalPrice()\n    };\n    return this.http.post('/api/orders', orderData);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}